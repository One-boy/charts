!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.MyCharts=e():t.MyCharts=e()}(window,function(){return function(t){var e={};function i(n){if(e[n])return e[n].exports;var s=e[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(n,s,function(e){return t[e]}.bind(null,s));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";i.r(e);const n={linear:function(t){return t},quadraticIn:function(t){return t*t},quadraticOut:function(t){return t*(2-t)},quadraticInOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)},cubicIn:function(t){return t*t*t},cubicOut:function(t){return--t*t*t+1},cubicInOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},quarticIn:function(t){return t*t*t*t},quarticOut:function(t){return 1- --t*t*t*t},quarticInOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},quinticIn:function(t){return t*t*t*t*t},quinticOut:function(t){return--t*t*t*t*t+1},quinticInOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},sinusoidalIn:function(t){return 1-Math.cos(t*Math.PI/2)},sinusoidalOut:function(t){return Math.sin(t*Math.PI/2)},sinusoidalInOut:function(t){return.5*(1-Math.cos(Math.PI*t))},exponentialIn:function(t){return 0===t?0:Math.pow(1024,t-1)},exponentialOut:function(t){return 1===t?1:1-Math.pow(2,-10*t)},exponentialInOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))},circularIn:function(t){return 1-Math.sqrt(1-t*t)},circularOut:function(t){return Math.sqrt(1- --t*t)},circularInOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},elasticIn:function(t){var e,i=.1;return 0===t?0:1===t?1:(!i||i<1?(i=1,e=.1):e=.4*Math.asin(1/i)/(2*Math.PI),-i*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/.4))},elasticOut:function(t){var e,i=.1;return 0===t?0:1===t?1:(!i||i<1?(i=1,e=.1):e=.4*Math.asin(1/i)/(2*Math.PI),i*Math.pow(2,-10*t)*Math.sin((t-e)*(2*Math.PI)/.4)+1)},elasticInOut:function(t){var e,i=.1;return 0===t?0:1===t?1:(!i||i<1?(i=1,e=.1):e=.4*Math.asin(1/i)/(2*Math.PI),(t*=2)<1?i*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/.4)*-.5:i*Math.pow(2,-10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/.4)*.5+1)},backIn:function(t){var e=1.70158;return t*t*((e+1)*t-e)},backOut:function(t){var e=1.70158;return--t*t*((e+1)*t+e)+1},backInOut:function(t){var e=2.5949095;return(t*=2)<1?t*t*((e+1)*t-e)*.5:.5*((t-=2)*t*((e+1)*t+e)+2)},bounceIn:function(t){return 1-n.bounceOut(1-t)},bounceOut:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},bounceInOut:function(t){return t<.5?.5*n.bounceIn(2*t):.5*n.bounceOut(2*t-1)+.5}};var s=n;var r=class{constructor({start:t=0,end:e=1e3,life:i=1e3,easing:n="linear"}){this._life=i,this._end=e,this._start=t,this._running=!0,this._current=this._start,this._easing=n}start(){this._startTime=(new Date).getTime(),this._loop()}_loop(){this._running&&(window.requestAnimationFrame(this._loop.bind(this)),this._update())}_update(){const t=((new Date).getTime()-this._startTime)/this._life,e=Math.min(t,1);1===e&&(this._running=!1);const i=s[this._easing](e);this._current=(this._end-this._start)*i,this._start<0&&(this._current-=Math.abs(this._start)),this._end-this._start<.001&&(this._current=this._end),this._fire("frame",this._current)}_fire(t,e){const i=`on${t}`;this[i]&&this[i](this._end,e)}stop(){this._running=!1}};var a=class{constructor(t){if(t instanceof HTMLElement?this.containerDom=t:this.containerDom=document.getElementById(t),!(this.containerDom instanceof HTMLElement))throw new TypeError(`${t} is not a valid dom Id !`);const e=window.devicePixelRatio||1,i=this.containerDom.offsetWidth,n=this.containerDom.offsetHeight;this.width=i*e,this.height=n*e,this.canvas=document.createElement("canvas"),this.containerDom.appendChild(this.canvas),this.canvas.width=this.width,this.canvas.height=this.height,this.canvas.style.width=`${this.width}px`,this.canvas.style.height=`${this.height}px`,this.ctx=this.canvas.getContext("2d"),this.startAngle=0,this.animationTime=1e3,this.easingName="quarticOut",this.baseColor="red",this.bottomColor="#ccc",this.centerPoint={x:this.width/2,y:this.height/2},this.carouselIndex=-1,this.isPauseCarousel=!1,this.addWidth=8,this.listen()}setOption(t){if("object"!=typeof t)throw new TypeError("options is not an object !");this.options=t,this.data=t.data,this.textStyle=t.textStyle;const{lineCap:e="round",arcGap:i=12,innerRadius:n=50,width:s=32,bottomColor:r="#eee"}=t.itemStyle;this.lineCap=e,this.arcGap=i,this.innerRadius=n,this.circleWidth=s,this.bottomColor=r,this.visualMap=t.visualMap,this.normalizeData(),this.render(),this.listen()}normalizeData(){if(!Array.isArray(this.data))throw new TypeError("data is not an Array !");if(!Array.isArray(this.visualMap))throw new TypeError("visualMap is not an Array !");this.data=this.data.map((t,e)=>{t.baseValue||(t.baseValue=100),t.percent=t.value/t.baseValue*100,t.percent=parseFloat(t.percent.toFixed(2));const i=this.visualMap.find(e=>t.value>=e.min&&t.value<=e.max);return t.color=i?i.color:this.baseColor,t.endAngle=this.percentToAngle(t.percent),t.r=this.innerRadius+(e+1)*(this.circleWidth+this.arcGap),t.animation=!0,t})}log(...t){console.log("ArcChart LOG:",...t)}listen(){this.canvas.addEventListener("mousemove",this.mouseMove.bind(this))}removeListen(){this.canvas.removeEventListener("mousemove",this.mouseMove.bind(this))}mouseMove(t){this.data.forEach(e=>{const i=this.containInArcLine({x:t.offsetX,y:t.offsetY},{centerPoint:this.centerPoint,r:e.r,lineWidth:this.circleWidth,startAngle:this.startAngle,endAngle:this.angleToRadian(e.endAngle)});i&&!e.circleWidth&&(e.circleWidth=this.circleWidth+this.arcGap/2,e.showText=!0,this.pauseCarousel(),this.drawArcs(!1)),!i&&e.circleWidth&&(e.showText=!1,e.circleWidth=0,this.drawArcs(!1))})}showText(t){const e={font:"sans-serif",fontSize:22,color:"black",fontWeight:"normal",...this.textStyle.title},i={font:"sans-serif",fontSize:32,color:t.color,fontWeight:"bold",...this.textStyle.subTitle};"auto"===i.color&&(i.color=t.color);let n=e.formatter.replace("{name}",t.name).replace("{percent}",t.percent).replace("{value}",t.value).replace("{baseValue}",t.baseValue),s=i.formatter.replace("{name}",t.name).replace("{percent}",t.percent).replace("{value}",t.value).replace("{baseValue}",t.baseValue);this.ctx.save(),this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.translate(this.width/2,this.height/2-.7*i.fontSize),this.ctx.font=`${e.fontWeight} ${e.fontSize}px ${e.fontFamily}`,this.ctx.fillStyle=e.color,this.ctx.fillText(n,0,0),this.ctx.restore(),this.ctx.save(),this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.translate(this.width/2,this.height/2+.7*i.fontSize),this.ctx.font=`${i.fontWeight} ${i.fontSize}px ${i.fontFamily}`,this.ctx.fillStyle=i.color,this.ctx.fillText(s,0,0),this.ctx.restore()}render(){this.drawArcs(!0)}drawArcs(t=!1){this.data.forEach((e,i)=>{if(!t||!e.animation)return void this.drawAll();const n=new r({start:this.startAngle,end:e.endAngle,life:this.animationTime,easing:this.easingName});n.onframe=((t,i)=>{e.endAngle=i,e.percent=this.angleToPercent(i),this.drawAll()}),n.start()})}drawAll(){this.clear(),this.data.forEach((t,e)=>{let i=0;this.isPauseCarousel||e!==this.carouselIndex||(i=this.addWidth),this.drawArc({lineWidth:(t.circleWidth||this.circleWidth)+i,centerPoint:this.centerPoint,r:t.r,startAngle:0,endAngle:this.angleToRadian(360),lineCap:this.lineCap,color:this.bottomColor}),this.drawArc({lineWidth:(t.circleWidth||this.circleWidth)+i,centerPoint:this.centerPoint,r:t.r,startAngle:this.angleToRadian(this.startAngle),endAngle:this.angleToRadian(t.endAngle),lineCap:this.lineCap,color:t.color}),t.showText&&this.showText(t)})}containInArcLine(t,e){const{centerPoint:i,r:n,lineWidth:s,startAngle:r,endAngle:a}=e;let{x:o,y:h}=t;if(o-=i.x,h-=i.y,0===s)return!1;const c=Math.sqrt(o*o+h*h);if(c<n-s/2||c>n+s/2)return!1;const l=2*Math.PI;if(Math.abs(r-a)%l<1e-4)return!0;let u=Math.atan2(h,o);return u<0&&(u+=l),u>=r&&u<=a}clear(){this.ctx.clearRect(0,0,this.width,this.height)}drawArc({lineWidth:t,centerPoint:e,r:i,startAngle:n,endAngle:s,lineCap:r="round",color:a}){this.ctx.save(),this.ctx.beginPath(),this.ctx.lineWidth=t,this.ctx.lineCap=r,this.ctx.translate(e.x,e.y),this.ctx.arc(0,0,i,n,s,!1),this.ctx.strokeStyle=a,this.ctx.stroke(),this.ctx.restore()}angleToRadian(t){return Math.PI*t/180}radianToAngle(t){return 180*t/Math.PI}percentToAngle(t){return t>=100?360:18*t/5}angleToPercent(t){return parseFloat((5*t/18).toFixed(0))}startCarousel(t=2e3){this.log("启动轮播"),this.stopCarousel(),this.isPauseCarousel=!1,this.carouselId=setTimeout(()=>{this.carouselIndex++,this.carouselIndex>=this.data.length&&(this.carouselIndex=0),this.data=this.data.map((t,e)=>(e===this.carouselIndex?(t.animation=!0,t.showText=!0):(t.animation=!1,t.showText=!1),t)),this.drawArcs(!0),this.startCarousel(t)},t)}pauseCarousel(){!this.isPauseCarousel&&this.carouselId&&(this.log("暂停轮播"),this.isPauseCarousel=!0,clearTimeout(this.carouselId),clearTimeout(this.restartCarouselId),this.restartCarouselId=setTimeout(this.startCarousel.bind(this),5e3))}stopCarousel(){this.isPauseCarousel=!1,clearTimeout(this.carouselId),clearTimeout(this.restartCarouselId)}resize(){this.log("resize");const t=window.devicePixelRatio||1,e=this.containerDom.offsetWidth,i=this.containerDom.offsetHeight;this.ctx.canvas.width===e*t&&this.ctx.canvas.height===i*t||(this.ctx.canvas.style.width=`${e}px`,this.ctx.canvas.style.height=`${i}px`,this.ctx.canvas.width=e*t,this.ctx.canvas.height=i*t,this.width=e*t,this.height=i*t,this.centerPoint={x:this.width/2,y:this.height/2},this.options&&this.setOption(this.options))}dispose(){this.restartCarouselId&&clearTimeout(this.restartCarouselId),this.carouselId&&clearTimeout(this.carouselId),this.removeListen()}};i.d(e,"Activity",function(){return a})}])});